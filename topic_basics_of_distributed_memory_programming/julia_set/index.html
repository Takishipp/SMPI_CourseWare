<!DOCTYPE html>
<html lang="en-us">


<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Topic &#35;1 Experience &middot; SMPI CourseWare
    
  </title>

  <!-- Semantic UI, JQuery, etc. -->
  <link rel="stylesheet" type="text/css" href="/SMPI_CourseWare//semantic/semantic.min.css">
  <link rel="stylesheet" type="text/css" href="/SMPI_CourseWare//public/basics.css">
  <link rel="stylesheet" type="text/css" href="/SMPI_CourseWare//public/syntax.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
  <script src="/SMPI_CourseWare//semantic/components/accordion.js"></script>
  <script src="/SMPI_CourseWare//semantic/components/popup.js"></script>
  <script src="/SMPI_CourseWare//semantic/components/transition.js"></script>
  <script src="/SMPI_CourseWare//semantic/components/tab.js"></script>

  <script language='javascript'>
               $(document).ready(function(){
               $('.ui.accordion').accordion();
               $('.popable')
                   .popup({
                     position: 'right center'
                   })
               ;
                 $('.menu .item').tab();

                 $('.paths.example .menu .item')
                     .tab({
                       context: '.paths.example'
                     })
                 ;

               });
  </script>


</head>



<body>

	

<div class="ui vertical left fixed menu basic  ">
  <br>
  <a href="http://simgrid.org" target="_blank">
  <img width=99 src="/SMPI_CourseWare/public/simgrid_logo.jpg" style="margin-left:5px">
  </a>
  <br>
  <br>




  <a class="ui item " href="/SMPI_CourseWare/">
    <h3 class="ui header">Home</h3>
  </a>


  
  
  
  
  
  <a class="ui popable item fluid " href="/SMPI_CourseWare//000_objectives/"
       data-content="Curricular information" data-variation="inverted">
      <h3 class="ui header fluid">About
      </h3>
  </a>
  
  
  
  
  
  
  
  <a class="ui popable item fluid " href="/SMPI_CourseWare//00_topic/"
       data-content="Getting started with SMPI" data-variation="inverted">
      <h3 class="ui header fluid">Topic &#35;0
      </h3>
  </a>
  
  
  
  
  
  
  
  <a class="ui popable item fluid  active" href="/SMPI_CourseWare//01_topic/"
       data-content="Basics of distributed memory programming" data-variation="inverted">
      <h3 class="ui header fluid">Topic &#35;1
      </h3>
  </a>
  
  
  
  
  
  
  
  <a class="ui popable item fluid " href="/SMPI_CourseWare//02_topic/"
       data-content="Communication on distributed platforms" data-variation="inverted">
      <h3 class="ui header fluid">Topic &#35;2
      </h3>
  </a>
  
  
  
  
  
  
  
  <a class="ui popable item fluid " href="/SMPI_CourseWare//03_topic/"
       data-content="Rigid distributed memory programs" data-variation="inverted">
      <h3 class="ui header fluid">Topic &#35;3
      </h3>
  </a>
  
  
  
  
  
  
  
  <a class="ui popable item fluid " href="/SMPI_CourseWare//04_topic/"
       data-content="Mitigating performance impact of communications" data-variation="inverted">
      <h3 class="ui header fluid">Topic &#35;4
      </h3>
  </a>
  
  
  
  
  
  
  
  <a class="ui popable item fluid " href="/SMPI_CourseWare//05_topic/"
       data-content="Flexible distributed memory programs" data-variation="inverted">
      <h3 class="ui header fluid">Topic &#35;5
      </h3>
  </a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <div class="ui divider" style="margin-top:0em"></div>

</div>



	<div class="contentpage container fluid">
	<div class="page">
  <br>
	
	<h1 class="ui header">Topic &#35;1 Experience: Computing a Julia Set</h1>
	
  <div class="ui divider"></div>

	<div class="ui pointing secondary menu">
  <a class="item active" data-tab="first">Introduction</a>
  <a class="item " data-tab="second">Activity #1</a>
  <a class="item" data-tab="third">Activity #2</a>
  <a class="item" data-tab="fourth">Activity #3</a>
</div>

<div class="ui tab segment active" data-tab="first">
  <div class="ui container raised segment fluid">

  <h3 class="ui header">Overview</h3>

  <p class="ui">
    <b>Objective: </b> To implement several versions of a "toy" parallel application that
    computes the Julia set displayed below and saves it as a bitmap file:
  </p>

  <p style="text-align:center;" class="ui">
    <img align="center" src="/SMPI_CourseWare//topic_basics_of_distributed_memory_programming/julia_set/julia_small.jpg" />

  </p>

  



<div class="ui accordion">
  <div class=" title">
    <i class="dropdown icon"></i>
    What is a Julia set?
  </div>
  <div class=" content">
    <div class="ui container message ">
      <p class="ui">A Julia set is a fractal, i.e., an object that is self-similar across scales (you "zoom in"
        and you keep seeing similar structures/features). It is a generalization
        of the famous Mandelbrot set<sup><a href="https://en.wikipedia.org/wiki/Mandelbrot_set">[Wikipedia]</a></sup>,
        which adorns many T-shirts (search for "Mandelbrot zoom" for psychedelic videos). </p>

      <p class="ui">The particular Julia set
        that we compute here is defined as follows. Given z a point in the 2-D complex plane, we compute the
        series defined as:
      <ul class="ui list">
        <li class="item">z<sub>0</sub> = z</li>
        <li class="item">z<sub>n+1</sub> = z<sub>n</sub><sup>2</sup> + c</li>
      </ul>
      where c = -0.79 + i * 0.15. Different
      values of c lead to different images, we know many values that produce "pretty" images.
      </p>
      <p class="ui">
        The color of a pixel corresponding to point z is determined based on the number of iterations
        before the modulus of z<sub>n</sub> is above 2 (or until a maximum number of iterations
        is reached).
      </p>
      <p class="ui">
        Not to worry, code is provided for you for the above. However, feel free to tweak it to create different
        images and to find out more about Julia sets<sup><a href="https://en.wikipedia.org/wiki/Julia_set">[Wikipedia]</a></sup>.
      </p>
    </div>
  </div>
</div>


</div>

<div class="ui container segment raised fluid">
  <h3 class="ui header">Roadmap</h3>
  <p class="ui">This experiences consists of <b>3 activities, each described in its own tab above, which should be done in
    sequence:</b>
  </p>
  <ul class="ui list">
    <li class="item"><b>Activity #1:</b> Realize a sequential implementation of a program that computes the Julia set
      and
      outputs it to a bmp file.
    </li>
    <li class="item"><b>Activity #2:</b> Realize a parallel implementation the program using MPI, using a 1-D data
      distribution.
    </li>
    <li class="item"><b>Activity #3:</b> Realize a parallel implementation the program using MPI, using a 2-D data
      distribution.
    </li>
  </ul>

</div>


<div class="ui container segment raised fluid">
  <h3 class="ui header">What to turn in</h3>
  <p class="ui">You should turn in a single archive (or a github repo) with:
  <div class="ui bulleted list">
    <div class="item">All source code</div>
    <div class="item">XML platform files (see details in the activities)</div>
    <div class="item">A Makefile that compiles all executables (and has a 'clean' target!)</div>
    <div class="item">A README file with answers to the questions asked in the activities</div>
  </div>
  </p>
</div>
</div>

<div class="ui tab segment " data-tab="second">
  In this activity we develop a simple sequential (i.e., non-parallel) programs that computes a
Julia set and saves it to a bitmap file. We break it down into the two steps below:
<br />

<div class="ui top attached tabular menu">
  <a class="item active" data-tab="seq_compute_julia">Step #1: Computing the Julia set</a>
  <a class="item" data-tab="seq_save_to_file">Step #2: Saving to a file</a>
</div>

<div class="ui bottom attached tab segment active" data-tab="seq_compute_julia">

  Implement a C (or C++) program called <code>sequential_julia</code> (source file  <code>sequential_julia.c</code>) that:

<div class="ui list bulleted">
  <div class="item">Takes a single command-line argument, n, an <code>integer</code> that's strictly positive.</div>
  <div class="item">Allocates an 1-D <code>unsigned char</code> n * (2 * n) *3 elements. This array is used to
    the pixels of an image with height (in pixels) of n width (in pixels) of 2n, where each pixel is encoded using 3 bytes (RGB
    values).
  </div>
  <div class="item">Fills this array with pixel values corresponding to the Julia set.</div>
</div>

<p class="ui">
  To make the above easier you are provided with one helper C function, <code>compute_julia_pixel()</code>, to which
  you pass the (x,y) coordinates of a pixed, the (width, height) dimensions of the image, a "tint" float (pass 1.0
  for now), and a pointer to 3 contiguous bytes (<code>unsigned char</code>). These bytes are set to appropriate
  RGB values (Red Green Blue) for displaying the Julia set.
  <a target="_blank" href="/SMPI_CourseWare/topic_basics_of_distributed_memory_programming/compute_julia_pixel.c">[Download
    source of compute_julia_pixel()]</a>
</p>

<div class="ui accordion fluid">
  <div class=" title">
    <i class="dropdown icon"></i>
    See the source of compute_julia_pixel()...
  </div>
  <div class=" content">
    <div class="ui raised container segment ">

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/*
 * compute_julia_pixel(): compute RBG values of a pixel in a
 *                        particular Julia set image.
 *
 *  In:
 *      (x,y):            pixel coordinates
 *      (width, height):  image dimensions
 *      tint_bias:        a float to "tweak" the tint (1.0 is "no tint")
 *  Out:
 *      rgb: an already-allocated 3-byte array into which R, G, and B
 *           values are written.
 *
 *  Return:
 *      0 in success, -1 on failure
 *
 */</span>

<span class="kt">int</span> <span class="nf">compute_julia_pixel</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">,</span> <span class="kt">float</span> <span class="n">tint_bias</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">rgb</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// Check coordinates
</span>  <span class="k">if</span> <span class="p">((</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">height</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">"Invalid (%d,%d) pixel coordinates in a %d x %d image</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// "Zoom in" to a pleasing view of the Julia set
</span>  <span class="kt">float</span> <span class="n">X_MIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">6</span><span class="p">,</span> <span class="n">X_MAX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">.</span><span class="mi">6</span><span class="p">,</span> <span class="n">Y_MIN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">9</span><span class="p">,</span> <span class="n">Y_MAX</span> <span class="o">=</span> <span class="o">+</span><span class="mi">0</span><span class="p">.</span><span class="mi">9</span><span class="p">;</span>
  <span class="kt">float</span> <span class="n">float_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">Y_MAX</span> <span class="o">-</span> <span class="n">Y_MIN</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">y</span> <span class="o">/</span> <span class="n">height</span> <span class="o">+</span> <span class="n">Y_MIN</span> <span class="p">;</span>
  <span class="kt">float</span> <span class="n">float_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_MAX</span> <span class="o">-</span> <span class="n">X_MIN</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">x</span> <span class="o">/</span> <span class="n">width</span>  <span class="o">+</span> <span class="n">X_MIN</span> <span class="p">;</span>

  <span class="c1">// Point that defines the Julia set
</span>  <span class="kt">float</span> <span class="n">julia_real</span> <span class="o">=</span> <span class="o">-</span><span class="p">.</span><span class="mi">79</span><span class="p">;</span>
  <span class="kt">float</span> <span class="n">julia_img</span> <span class="o">=</span> <span class="p">.</span><span class="mi">15</span><span class="p">;</span>

  <span class="c1">// Maximum number of iteration
</span>  <span class="kt">int</span> <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">300</span><span class="p">;</span>

  <span class="c1">// Compute the complex series convergence
</span>  <span class="kt">float</span> <span class="n">real</span><span class="o">=</span><span class="n">float_y</span><span class="p">,</span> <span class="n">img</span><span class="o">=</span><span class="n">float_x</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">num_iter</span> <span class="o">=</span> <span class="n">max_iter</span><span class="p">;</span>
  <span class="k">while</span> <span class="p">((</span> <span class="n">img</span> <span class="o">*</span> <span class="n">img</span> <span class="o">+</span> <span class="n">real</span> <span class="o">*</span> <span class="n">real</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">2</span> <span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="n">num_iter</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">))</span> <span class="p">{</span>
    <span class="kt">float</span> <span class="n">xtemp</span> <span class="o">=</span> <span class="n">img</span> <span class="o">*</span> <span class="n">img</span> <span class="o">-</span> <span class="n">real</span> <span class="o">*</span> <span class="n">real</span> <span class="o">+</span> <span class="n">julia_real</span><span class="p">;</span>
    <span class="n">real</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">img</span> <span class="o">*</span> <span class="n">real</span> <span class="o">+</span> <span class="n">julia_img</span><span class="p">;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">xtemp</span><span class="p">;</span>
    <span class="n">num_iter</span><span class="o">--</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Paint pixel based on how many iterations were used, using some funky colors
</span>  <span class="kt">float</span> <span class="n">color_bias</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span> <span class="n">num_iter</span> <span class="o">/</span> <span class="n">max_iter</span><span class="p">;</span>
  <span class="n">rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_iter</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">200</span> <span class="o">:</span> <span class="o">-</span> <span class="mi">500</span><span class="p">.</span><span class="mi">0</span> <span class="o">*</span> <span class="n">pow</span><span class="p">(</span><span class="n">tint_bias</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span>  <span class="n">pow</span><span class="p">(</span><span class="n">color_bias</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">6</span><span class="p">));</span>
  <span class="n">rgb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_iter</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">100</span> <span class="o">:</span> <span class="o">-</span><span class="mi">255</span><span class="p">.</span><span class="mi">0</span> <span class="o">*</span>  <span class="n">pow</span><span class="p">(</span><span class="n">color_bias</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="p">));</span>
  <span class="n">rgb</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_iter</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">100</span> <span class="o">:</span> <span class="mi">255</span> <span class="o">-</span> <span class="mi">255</span><span class="p">.</span><span class="mi">0</span> <span class="o">*</span> <span class="n">pow</span><span class="p">(</span><span class="n">tint_bias</span><span class="p">,</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">pow</span><span class="p">(</span><span class="n">color_bias</span><span class="p">,</span> <span class="mi">3</span><span class="p">.</span><span class="mi">0</span><span class="p">));</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

    </div>
  </div>
</div>

<br />

<p class="ui">
  The program must store the pixels of the 2-D image into a <b>1-D array using a <i>row-major scheme</i></b>.
</p>


<div class="ui accordion fluid">
  <div class=" title">
    <i class="dropdown icon"></i>
    See more details about this "row-major" business...
  </div>

  <div class="content">
    <div class="ui container raised segment">
      <h4 class="ui header">Storing 2-D data is a row-major 1-D array</h4>
      <p class="ui">
        You may find the use of a 1-D array to store the pixels surprising, since after all the image is 2-D. However, it is
        common to use 1-D arrays, especially when they are dynamically allocated. One option would be to allocate an array
        of pointers to
        1-D arrays, making it possible to access elements with the convenient syntax <code>Array[i][j]</code>.
        But this is typically a bad idea as it reduces locality (i.e., the efficient use of the cache), which in turns harms
        performance.
      </p>
      <p>Therefore, we instead store 2-D data into a 1-D array of contiguous elements. The "row-major" scheme consists in storing rows in sequence. In other
        terms, if the width of the image is <code>N</code>, then pixel (i,j) is stored as <code>Array[i * N + j]</code>. This is actually
        the scheme used by the C language to store 2-D arrays.
      </p>
    </div>
  </div>
</div>
<br />


Now that the program computes the Julia set pixels as a 1-D array of 3-byte elements, it would be nice to see them (if only to check
that they're set correctly). So move on to Step #2 (next tab)...





</div>



<div class="ui bottom attached tab segment" data-tab="seq_save_to_file">

  <p class="ui">
Augment your program so that it saves the image to a file called <code>julia.bmp</code>, which stores
the image in the bmp format.  A bmp file consists of two parts:
  <div class="ui list bulleted">
  <div class="ui item"> A header </div>
  <div class="ui item"> The 3-byte pixels of the image, in a row-major fashion</div>
</div>

  </p>

<p class="ui">
  To make the above easier you are provided with a helper C function, <code>write_bmp_header()</code>, which
  writes to a file the 40-byte header required for a bmp file.
  <a target="_blank" href="/SMPI_CourseWare/topic_basics_of_distributed_memory_programming/write_bmp_header.c">[Download
    source of write_bmp_header()]</a>
</p>

<div class="ui accordion fluid">
  <div class=" title">
    <i class="dropdown icon"></i>
    See the source of write_bmp_header()...
  </div>
  <div class=" content">
    <div class="ui raised container segment ">

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/* write_bmp_header():
 *
 *   In:
 *      f: A file open for writing ('w') 
 *      (width, height): image dimensions
 *   
 *   Return:
 *      0 on success, -1 on failure
 *
 */</span>

<span class="kt">int</span> <span class="nf">write_bmp_header</span><span class="p">(</span><span class="kt">FILE</span> <span class="o">*</span><span class="n">f</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span> <span class="p">{</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">row_size_in_bytes</span> <span class="o">=</span> <span class="n">width</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> 
	  <span class="p">((</span><span class="n">width</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="p">(</span><span class="n">width</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">));</span>

  <span class="c1">// Define all fields in the bmp header
</span>  <span class="kt">char</span> <span class="n">id</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s">"BM"</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">filesize</span> <span class="o">=</span> <span class="mi">54</span> <span class="o">+</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">row_size_in_bytes</span> <span class="o">*</span> <span class="n">height</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
  <span class="kt">short</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">offset</span> <span class="o">=</span> <span class="mi">54</span><span class="p">;</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">planes</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bits</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">compression</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">image_size</span> <span class="o">=</span> <span class="n">width</span> <span class="o">*</span> <span class="n">height</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">x_res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">y_res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ncolors</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">importantcolors</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="c1">// Write the bytes to the file, keeping track of the
</span>  <span class="c1">// number of written "objects"
</span>  <span class="kt">size_t</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="n">id</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">filesize</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="n">reserved</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">short</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">offset</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">width</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">height</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">planes</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">short</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bits</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">short</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">compression</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">image_size</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x_res</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">y_res</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ncolors</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>
  <span class="n">ret</span> <span class="o">+=</span> <span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">importantcolors</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span>

  <span class="c1">// Success means that we wrote 17 "objects" successfully
</span>  <span class="k">return</span> <span class="p">(</span><span class="n">ret</span> <span class="o">!=</span> <span class="mi">17</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

    </div>
  </div>
</div>

<p class="ui">
  <b>Warning: </b> If the number of width of the image in number of pixels, 2n, is not a multiple of 4 (i.e., in our case
  if n is odd), then the bmp file format requires that each row of pixel be <i>padded</i>. This means that
  extra bytes must be written to the file to make the number of bytes in each pixel row a multiple of 4 in case it
  is not.  <b>For
  our purposes, you can simply assume that n is always even, so that no padding is necessary.</b> But if you want to allow odd values of n, then you must
  write extra padding bytes to the file after each row of pixels (for instance bytes with value 0).
</p>



<p class="ui">
  Verify that your program outputs the expected Julia set, by opening the bmp file with your favorite
  image viewer. Try different values of n and check that
  your obtain images with the expected resolutions.
</p>


<p class="ui">
  You are now ready to go on to Activity #2, in which we make the program parallel.
</p>



</div>
</div>

<div class="ui tab segment" data-tab="third">
  In this activity we develop a parallel implementation of the program using
a simple "1-D data distribution". We break it down into the three steps below:
<br />

<div class="ui top attached tabular menu">
  <a class="item active" data-tab="1D_data_distribution">Step #1: Data distribution</a>
  <a class="item" data-tab="1D_compute_julia">Step #2: Computing the Julia set</a>
  <a class="item" data-tab="1D_save_to_file">Step #3: Saving to a file</a>
</div>

<div class="ui bottom attached tab segment active" data-tab="1D_data_distribution">

  <p class="ui">
  The first step when designing a distributed-memory program is to pick a particular
  "data distribution", i.e., a way in which the data (input and or output) is
  split across the participating processes. In our Julia set program, the only data
  is the output image, and we opt for a simple and popular data-distribution scheme:
  <b>a 1-D data-distribution</b>. Simply put, we logically split our image into slabs
  and each process computes one slab.
</p>

<p class="ui">Because in the previous activity we used
  a <i>row-major</i> storing scheme for our image, it makes sense to pick horizontal
  slabs.  Our image has n rows of pixels (recall that n is the integer
  command-line argument).  Let us first compute the data distribution,
  without computing the Julia set at all. The idea is that, based on its rank, each
  process must figure out which rows it will compute.
</p>


<p class="ui">
  Implement a C (or C++) MPI program called <code>1D_parallel_julia</code> (source file  <code>1D_parallel_julia.c</code>)
  that:
</p>

<div class="ui list bulleted">
  <div class="item">Takes a single command-line argument, n, an integer that's strictly positive.</div>
  <div class="item">Have each process print out its rank (out of how many processes in total), and
          which rows of the image (as a range) it should compute (but actually do nothing for now). See the sample
           executions below to see what kind of output is expected.</div>
  <div class="item">The intended data distribution should be in as many "slabs" as there are processes, where
    each process is in charge of a set of contiguous rows.</div>
  <div class="item">The distribution should be <b>as balanced as possible</b> (at most
    a difference of one row between two processes)</div>
</div>

<p class="ui">
  Run your program on this simple simulated 1024-node cluster
  (download <a href="simple_cluster.xml">simple_cluster.xml</a> and
  <a href="simple_cluster_hostfile.txt">simple_cluster_hostfile.txt</a>).
</p>

<div class="ui accordion fluid">
  <div class=" title">
    <i class="dropdown icon"></i>
    See the content of simple_cluster.xml ...
  </div>
  <div class=" content">
    <div class="ui raised container segment ">
      
<figure class="highlight"><pre><code class="language-xml" data-lang="xml">      <span class="cp">&lt;?xml version='1.0'?&gt;</span>
<span class="cp">&lt;!DOCTYPE platform SYSTEM "http://simgrid.gforge.inria.fr/simgrid.dtd"&gt;</span>
<span class="nt">&lt;platform</span> <span class="na">version=</span><span class="s">"3"</span><span class="nt">&gt;</span>
<span class="nt">&lt;AS</span> <span class="na">id=</span><span class="s">"AS0"</span> <span class="na">routing=</span><span class="s">"Full"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;cluster</span> <span class="na">id=</span><span class="s">"simple_cluster"</span> <span class="na">prefix=</span><span class="s">"host-"</span> <span class="na">suffix=</span><span class="s">".me.org"</span>
           <span class="na">radical=</span><span class="s">"0-1023"</span> <span class="na">power=</span><span class="s">"1Gf"</span> <span class="na">bw=</span><span class="s">"500MBps"</span> <span class="na">lat=</span><span class="s">"5us"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/AS&gt;</span>
<span class="nt">&lt;/platform&gt;</span>

      </code></pre></figure>

    </div>
  </div>
  <div class=" title">
    <i class="dropdown icon"></i>
    See the (long and boring) content of simple_cluster_hostfile.txt ...
  </div>
  <div class=" content">
    <div class="ui raised container segment ">
      
<figure class="highlight"><pre><code class="language-text" data-lang="text">      host-0.me.org
host-1.me.org
host-2.me.org
host-3.me.org
host-4.me.org
host-5.me.org
host-6.me.org
host-7.me.org
host-8.me.org
host-9.me.org
host-10.me.org
host-11.me.org
host-12.me.org
host-13.me.org
host-14.me.org
host-15.me.org
host-16.me.org
host-17.me.org
host-18.me.org
host-19.me.org
host-20.me.org
host-21.me.org
host-22.me.org
host-23.me.org
host-24.me.org
host-25.me.org
host-26.me.org
host-27.me.org
host-28.me.org
host-29.me.org
host-30.me.org
host-31.me.org
host-32.me.org
host-33.me.org
host-34.me.org
host-35.me.org
host-36.me.org
host-37.me.org
host-38.me.org
host-39.me.org
host-40.me.org
host-41.me.org
host-42.me.org
host-43.me.org
host-44.me.org
host-45.me.org
host-46.me.org
host-47.me.org
host-48.me.org
host-49.me.org
host-50.me.org
host-51.me.org
host-52.me.org
host-53.me.org
host-54.me.org
host-55.me.org
host-56.me.org
host-57.me.org
host-58.me.org
host-59.me.org
host-60.me.org
host-61.me.org
host-62.me.org
host-63.me.org
host-64.me.org
host-65.me.org
host-66.me.org
host-67.me.org
host-68.me.org
host-69.me.org
host-70.me.org
host-71.me.org
host-72.me.org
host-73.me.org
host-74.me.org
host-75.me.org
host-76.me.org
host-77.me.org
host-78.me.org
host-79.me.org
host-80.me.org
host-81.me.org
host-82.me.org
host-83.me.org
host-84.me.org
host-85.me.org
host-86.me.org
host-87.me.org
host-88.me.org
host-89.me.org
host-90.me.org
host-91.me.org
host-92.me.org
host-93.me.org
host-94.me.org
host-95.me.org
host-96.me.org
host-97.me.org
host-98.me.org
host-99.me.org
host-100.me.org
host-101.me.org
host-102.me.org
host-103.me.org
host-104.me.org
host-105.me.org
host-106.me.org
host-107.me.org
host-108.me.org
host-109.me.org
host-110.me.org
host-111.me.org
host-112.me.org
host-113.me.org
host-114.me.org
host-115.me.org
host-116.me.org
host-117.me.org
host-118.me.org
host-119.me.org
host-120.me.org
host-121.me.org
host-122.me.org
host-123.me.org
host-124.me.org
host-125.me.org
host-126.me.org
host-127.me.org
host-128.me.org
host-129.me.org
host-130.me.org
host-131.me.org
host-132.me.org
host-133.me.org
host-134.me.org
host-135.me.org
host-136.me.org
host-137.me.org
host-138.me.org
host-139.me.org
host-140.me.org
host-141.me.org
host-142.me.org
host-143.me.org
host-144.me.org
host-145.me.org
host-146.me.org
host-147.me.org
host-148.me.org
host-149.me.org
host-150.me.org
host-151.me.org
host-152.me.org
host-153.me.org
host-154.me.org
host-155.me.org
host-156.me.org
host-157.me.org
host-158.me.org
host-159.me.org
host-160.me.org
host-161.me.org
host-162.me.org
host-163.me.org
host-164.me.org
host-165.me.org
host-166.me.org
host-167.me.org
host-168.me.org
host-169.me.org
host-170.me.org
host-171.me.org
host-172.me.org
host-173.me.org
host-174.me.org
host-175.me.org
host-176.me.org
host-177.me.org
host-178.me.org
host-179.me.org
host-180.me.org
host-181.me.org
host-182.me.org
host-183.me.org
host-184.me.org
host-185.me.org
host-186.me.org
host-187.me.org
host-188.me.org
host-189.me.org
host-190.me.org
host-191.me.org
host-192.me.org
host-193.me.org
host-194.me.org
host-195.me.org
host-196.me.org
host-197.me.org
host-198.me.org
host-199.me.org
host-200.me.org
host-201.me.org
host-202.me.org
host-203.me.org
host-204.me.org
host-205.me.org
host-206.me.org
host-207.me.org
host-208.me.org
host-209.me.org
host-210.me.org
host-211.me.org
host-212.me.org
host-213.me.org
host-214.me.org
host-215.me.org
host-216.me.org
host-217.me.org
host-218.me.org
host-219.me.org
host-220.me.org
host-221.me.org
host-222.me.org
host-223.me.org
host-224.me.org
host-225.me.org
host-226.me.org
host-227.me.org
host-228.me.org
host-229.me.org
host-230.me.org
host-231.me.org
host-232.me.org
host-233.me.org
host-234.me.org
host-235.me.org
host-236.me.org
host-237.me.org
host-238.me.org
host-239.me.org
host-240.me.org
host-241.me.org
host-242.me.org
host-243.me.org
host-244.me.org
host-245.me.org
host-246.me.org
host-247.me.org
host-248.me.org
host-249.me.org
host-250.me.org
host-251.me.org
host-252.me.org
host-253.me.org
host-254.me.org
host-255.me.org
host-256.me.org
host-257.me.org
host-258.me.org
host-259.me.org
host-260.me.org
host-261.me.org
host-262.me.org
host-263.me.org
host-264.me.org
host-265.me.org
host-266.me.org
host-267.me.org
host-268.me.org
host-269.me.org
host-270.me.org
host-271.me.org
host-272.me.org
host-273.me.org
host-274.me.org
host-275.me.org
host-276.me.org
host-277.me.org
host-278.me.org
host-279.me.org
host-280.me.org
host-281.me.org
host-282.me.org
host-283.me.org
host-284.me.org
host-285.me.org
host-286.me.org
host-287.me.org
host-288.me.org
host-289.me.org
host-290.me.org
host-291.me.org
host-292.me.org
host-293.me.org
host-294.me.org
host-295.me.org
host-296.me.org
host-297.me.org
host-298.me.org
host-299.me.org
host-300.me.org
host-301.me.org
host-302.me.org
host-303.me.org
host-304.me.org
host-305.me.org
host-306.me.org
host-307.me.org
host-308.me.org
host-309.me.org
host-310.me.org
host-311.me.org
host-312.me.org
host-313.me.org
host-314.me.org
host-315.me.org
host-316.me.org
host-317.me.org
host-318.me.org
host-319.me.org
host-320.me.org
host-321.me.org
host-322.me.org
host-323.me.org
host-324.me.org
host-325.me.org
host-326.me.org
host-327.me.org
host-328.me.org
host-329.me.org
host-330.me.org
host-331.me.org
host-332.me.org
host-333.me.org
host-334.me.org
host-335.me.org
host-336.me.org
host-337.me.org
host-338.me.org
host-339.me.org
host-340.me.org
host-341.me.org
host-342.me.org
host-343.me.org
host-344.me.org
host-345.me.org
host-346.me.org
host-347.me.org
host-348.me.org
host-349.me.org
host-350.me.org
host-351.me.org
host-352.me.org
host-353.me.org
host-354.me.org
host-355.me.org
host-356.me.org
host-357.me.org
host-358.me.org
host-359.me.org
host-360.me.org
host-361.me.org
host-362.me.org
host-363.me.org
host-364.me.org
host-365.me.org
host-366.me.org
host-367.me.org
host-368.me.org
host-369.me.org
host-370.me.org
host-371.me.org
host-372.me.org
host-373.me.org
host-374.me.org
host-375.me.org
host-376.me.org
host-377.me.org
host-378.me.org
host-379.me.org
host-380.me.org
host-381.me.org
host-382.me.org
host-383.me.org
host-384.me.org
host-385.me.org
host-386.me.org
host-387.me.org
host-388.me.org
host-389.me.org
host-390.me.org
host-391.me.org
host-392.me.org
host-393.me.org
host-394.me.org
host-395.me.org
host-396.me.org
host-397.me.org
host-398.me.org
host-399.me.org
host-400.me.org
host-401.me.org
host-402.me.org
host-403.me.org
host-404.me.org
host-405.me.org
host-406.me.org
host-407.me.org
host-408.me.org
host-409.me.org
host-410.me.org
host-411.me.org
host-412.me.org
host-413.me.org
host-414.me.org
host-415.me.org
host-416.me.org
host-417.me.org
host-418.me.org
host-419.me.org
host-420.me.org
host-421.me.org
host-422.me.org
host-423.me.org
host-424.me.org
host-425.me.org
host-426.me.org
host-427.me.org
host-428.me.org
host-429.me.org
host-430.me.org
host-431.me.org
host-432.me.org
host-433.me.org
host-434.me.org
host-435.me.org
host-436.me.org
host-437.me.org
host-438.me.org
host-439.me.org
host-440.me.org
host-441.me.org
host-442.me.org
host-443.me.org
host-444.me.org
host-445.me.org
host-446.me.org
host-447.me.org
host-448.me.org
host-449.me.org
host-450.me.org
host-451.me.org
host-452.me.org
host-453.me.org
host-454.me.org
host-455.me.org
host-456.me.org
host-457.me.org
host-458.me.org
host-459.me.org
host-460.me.org
host-461.me.org
host-462.me.org
host-463.me.org
host-464.me.org
host-465.me.org
host-466.me.org
host-467.me.org
host-468.me.org
host-469.me.org
host-470.me.org
host-471.me.org
host-472.me.org
host-473.me.org
host-474.me.org
host-475.me.org
host-476.me.org
host-477.me.org
host-478.me.org
host-479.me.org
host-480.me.org
host-481.me.org
host-482.me.org
host-483.me.org
host-484.me.org
host-485.me.org
host-486.me.org
host-487.me.org
host-488.me.org
host-489.me.org
host-490.me.org
host-491.me.org
host-492.me.org
host-493.me.org
host-494.me.org
host-495.me.org
host-496.me.org
host-497.me.org
host-498.me.org
host-499.me.org
host-500.me.org
host-501.me.org
host-502.me.org
host-503.me.org
host-504.me.org
host-505.me.org
host-506.me.org
host-507.me.org
host-508.me.org
host-509.me.org
host-510.me.org
host-511.me.org
host-512.me.org
host-513.me.org
host-514.me.org
host-515.me.org
host-516.me.org
host-517.me.org
host-518.me.org
host-519.me.org
host-520.me.org
host-521.me.org
host-522.me.org
host-523.me.org
host-524.me.org
host-525.me.org
host-526.me.org
host-527.me.org
host-528.me.org
host-529.me.org
host-530.me.org
host-531.me.org
host-532.me.org
host-533.me.org
host-534.me.org
host-535.me.org
host-536.me.org
host-537.me.org
host-538.me.org
host-539.me.org
host-540.me.org
host-541.me.org
host-542.me.org
host-543.me.org
host-544.me.org
host-545.me.org
host-546.me.org
host-547.me.org
host-548.me.org
host-549.me.org
host-550.me.org
host-551.me.org
host-552.me.org
host-553.me.org
host-554.me.org
host-555.me.org
host-556.me.org
host-557.me.org
host-558.me.org
host-559.me.org
host-560.me.org
host-561.me.org
host-562.me.org
host-563.me.org
host-564.me.org
host-565.me.org
host-566.me.org
host-567.me.org
host-568.me.org
host-569.me.org
host-570.me.org
host-571.me.org
host-572.me.org
host-573.me.org
host-574.me.org
host-575.me.org
host-576.me.org
host-577.me.org
host-578.me.org
host-579.me.org
host-580.me.org
host-581.me.org
host-582.me.org
host-583.me.org
host-584.me.org
host-585.me.org
host-586.me.org
host-587.me.org
host-588.me.org
host-589.me.org
host-590.me.org
host-591.me.org
host-592.me.org
host-593.me.org
host-594.me.org
host-595.me.org
host-596.me.org
host-597.me.org
host-598.me.org
host-599.me.org
host-600.me.org
host-601.me.org
host-602.me.org
host-603.me.org
host-604.me.org
host-605.me.org
host-606.me.org
host-607.me.org
host-608.me.org
host-609.me.org
host-610.me.org
host-611.me.org
host-612.me.org
host-613.me.org
host-614.me.org
host-615.me.org
host-616.me.org
host-617.me.org
host-618.me.org
host-619.me.org
host-620.me.org
host-621.me.org
host-622.me.org
host-623.me.org
host-624.me.org
host-625.me.org
host-626.me.org
host-627.me.org
host-628.me.org
host-629.me.org
host-630.me.org
host-631.me.org
host-632.me.org
host-633.me.org
host-634.me.org
host-635.me.org
host-636.me.org
host-637.me.org
host-638.me.org
host-639.me.org
host-640.me.org
host-641.me.org
host-642.me.org
host-643.me.org
host-644.me.org
host-645.me.org
host-646.me.org
host-647.me.org
host-648.me.org
host-649.me.org
host-650.me.org
host-651.me.org
host-652.me.org
host-653.me.org
host-654.me.org
host-655.me.org
host-656.me.org
host-657.me.org
host-658.me.org
host-659.me.org
host-660.me.org
host-661.me.org
host-662.me.org
host-663.me.org
host-664.me.org
host-665.me.org
host-666.me.org
host-667.me.org
host-668.me.org
host-669.me.org
host-670.me.org
host-671.me.org
host-672.me.org
host-673.me.org
host-674.me.org
host-675.me.org
host-676.me.org
host-677.me.org
host-678.me.org
host-679.me.org
host-680.me.org
host-681.me.org
host-682.me.org
host-683.me.org
host-684.me.org
host-685.me.org
host-686.me.org
host-687.me.org
host-688.me.org
host-689.me.org
host-690.me.org
host-691.me.org
host-692.me.org
host-693.me.org
host-694.me.org
host-695.me.org
host-696.me.org
host-697.me.org
host-698.me.org
host-699.me.org
host-700.me.org
host-701.me.org
host-702.me.org
host-703.me.org
host-704.me.org
host-705.me.org
host-706.me.org
host-707.me.org
host-708.me.org
host-709.me.org
host-710.me.org
host-711.me.org
host-712.me.org
host-713.me.org
host-714.me.org
host-715.me.org
host-716.me.org
host-717.me.org
host-718.me.org
host-719.me.org
host-720.me.org
host-721.me.org
host-722.me.org
host-723.me.org
host-724.me.org
host-725.me.org
host-726.me.org
host-727.me.org
host-728.me.org
host-729.me.org
host-730.me.org
host-731.me.org
host-732.me.org
host-733.me.org
host-734.me.org
host-735.me.org
host-736.me.org
host-737.me.org
host-738.me.org
host-739.me.org
host-740.me.org
host-741.me.org
host-742.me.org
host-743.me.org
host-744.me.org
host-745.me.org
host-746.me.org
host-747.me.org
host-748.me.org
host-749.me.org
host-750.me.org
host-751.me.org
host-752.me.org
host-753.me.org
host-754.me.org
host-755.me.org
host-756.me.org
host-757.me.org
host-758.me.org
host-759.me.org
host-760.me.org
host-761.me.org
host-762.me.org
host-763.me.org
host-764.me.org
host-765.me.org
host-766.me.org
host-767.me.org
host-768.me.org
host-769.me.org
host-770.me.org
host-771.me.org
host-772.me.org
host-773.me.org
host-774.me.org
host-775.me.org
host-776.me.org
host-777.me.org
host-778.me.org
host-779.me.org
host-780.me.org
host-781.me.org
host-782.me.org
host-783.me.org
host-784.me.org
host-785.me.org
host-786.me.org
host-787.me.org
host-788.me.org
host-789.me.org
host-790.me.org
host-791.me.org
host-792.me.org
host-793.me.org
host-794.me.org
host-795.me.org
host-796.me.org
host-797.me.org
host-798.me.org
host-799.me.org
host-800.me.org
host-801.me.org
host-802.me.org
host-803.me.org
host-804.me.org
host-805.me.org
host-806.me.org
host-807.me.org
host-808.me.org
host-809.me.org
host-810.me.org
host-811.me.org
host-812.me.org
host-813.me.org
host-814.me.org
host-815.me.org
host-816.me.org
host-817.me.org
host-818.me.org
host-819.me.org
host-820.me.org
host-821.me.org
host-822.me.org
host-823.me.org
host-824.me.org
host-825.me.org
host-826.me.org
host-827.me.org
host-828.me.org
host-829.me.org
host-830.me.org
host-831.me.org
host-832.me.org
host-833.me.org
host-834.me.org
host-835.me.org
host-836.me.org
host-837.me.org
host-838.me.org
host-839.me.org
host-840.me.org
host-841.me.org
host-842.me.org
host-843.me.org
host-844.me.org
host-845.me.org
host-846.me.org
host-847.me.org
host-848.me.org
host-849.me.org
host-850.me.org
host-851.me.org
host-852.me.org
host-853.me.org
host-854.me.org
host-855.me.org
host-856.me.org
host-857.me.org
host-858.me.org
host-859.me.org
host-860.me.org
host-861.me.org
host-862.me.org
host-863.me.org
host-864.me.org
host-865.me.org
host-866.me.org
host-867.me.org
host-868.me.org
host-869.me.org
host-870.me.org
host-871.me.org
host-872.me.org
host-873.me.org
host-874.me.org
host-875.me.org
host-876.me.org
host-877.me.org
host-878.me.org
host-879.me.org
host-880.me.org
host-881.me.org
host-882.me.org
host-883.me.org
host-884.me.org
host-885.me.org
host-886.me.org
host-887.me.org
host-888.me.org
host-889.me.org
host-890.me.org
host-891.me.org
host-892.me.org
host-893.me.org
host-894.me.org
host-895.me.org
host-896.me.org
host-897.me.org
host-898.me.org
host-899.me.org
host-900.me.org
host-901.me.org
host-902.me.org
host-903.me.org
host-904.me.org
host-905.me.org
host-906.me.org
host-907.me.org
host-908.me.org
host-909.me.org
host-910.me.org
host-911.me.org
host-912.me.org
host-913.me.org
host-914.me.org
host-915.me.org
host-916.me.org
host-917.me.org
host-918.me.org
host-919.me.org
host-920.me.org
host-921.me.org
host-922.me.org
host-923.me.org
host-924.me.org
host-925.me.org
host-926.me.org
host-927.me.org
host-928.me.org
host-929.me.org
host-930.me.org
host-931.me.org
host-932.me.org
host-933.me.org
host-934.me.org
host-935.me.org
host-936.me.org
host-937.me.org
host-938.me.org
host-939.me.org
host-940.me.org
host-941.me.org
host-942.me.org
host-943.me.org
host-944.me.org
host-945.me.org
host-946.me.org
host-947.me.org
host-948.me.org
host-949.me.org
host-950.me.org
host-951.me.org
host-952.me.org
host-953.me.org
host-954.me.org
host-955.me.org
host-956.me.org
host-957.me.org
host-958.me.org
host-959.me.org
host-960.me.org
host-961.me.org
host-962.me.org
host-963.me.org
host-964.me.org
host-965.me.org
host-966.me.org
host-967.me.org
host-968.me.org
host-969.me.org
host-970.me.org
host-971.me.org
host-972.me.org
host-973.me.org
host-974.me.org
host-975.me.org
host-976.me.org
host-977.me.org
host-978.me.org
host-979.me.org
host-980.me.org
host-981.me.org
host-982.me.org
host-983.me.org
host-984.me.org
host-985.me.org
host-986.me.org
host-987.me.org
host-988.me.org
host-989.me.org
host-990.me.org
host-991.me.org
host-992.me.org
host-993.me.org
host-994.me.org
host-995.me.org
host-996.me.org
host-997.me.org
host-998.me.org
host-999.me.org
host-1000.me.org
host-1001.me.org
host-1002.me.org
host-1003.me.org
host-1004.me.org
host-1005.me.org
host-1006.me.org
host-1007.me.org
host-1008.me.org
host-1009.me.org
host-1010.me.org
host-1011.me.org
host-1012.me.org
host-1013.me.org
host-1014.me.org
host-1015.me.org
host-1016.me.org
host-1017.me.org
host-1018.me.org
host-1019.me.org
host-1020.me.org
host-1021.me.org
host-1022.me.org
host-1023.me.org

      </code></pre></figure>

    </div>
  </div>
</div>

<br />
<div class="ui divider"></div>


<p class="ui">
  Below are a few sample executions of the program:
</p>

<div class="ui accordion  fluid">

  <div class="title">
    <i class="dropdown icon"></i>
    See a sample execution with 5 processes for n=1000 ...
  </div>

  <div class="  styled content">

    <div class="ui container raised segment">
      <h5 class="ui">As expected, each process process should process 200 rows:</h5>

<figure class="highlight"><pre><code class="language-text" data-lang="text">% smpicc -O3 1D_parallel_julia.c -o 1D_parallel_julia
% smpirun --cfg=smpi/running_power:1 -np 5 -hostfile ./simple_cluster_hostfile.txt -platform ./simple_cluster.xml ./1D_parallel_julia 1000
[Process 0 out of 5]: I should compute pixel rows 0 to 199, for a total of 200 rows
[Process 1 out of 5]: I should compute pixel rows 200 to 399, for a total of 200 rows
[Process 2 out of 5]: I should compute pixel rows 400 to 599, for a total of 200 rows
[Process 3 out of 5]: I should compute pixel rows 600 to 799, for a total of 200 rows
[Process 4 out of 5]: I should compute pixel rows 800 to 999, for a total of 200 rows</code></pre></figure>

    </div>
  </div>

  <div class=" title">
    <i class="dropdown icon"></i>
    See a sample execution with 16 processes for n=100 ...
  </div>

  <div class=" content">
    <div class="ui container segment raised">
      <h5 class="ui">Note that the distribution is balanced, meaning that the number of rows
        differs by at most 1 across processors. This is not the only possible balanced data distribution (e.g.,
      process 0 could compute only 6 rows, while process 15 could compute 7 rows).</h5>

<figure class="highlight"><pre><code class="language-text" data-lang="text">% smpicc -O3 1D_parallel_julia.c -o 1D_parallel_julia
% smpirun --cfg=smpi/running_power:1 -np 16 -hostfile ./simple_cluster_hostfile.txt -platform ./simple_cluster.xml ./1D_parallel_julia 100
[Process 0 out of 16]: I should compute pixel rows 0 to 6, for a total of 7 rows
[Process 1 out of 16]: I should compute pixel rows 7 to 13, for a total of 7 rows
[Process 2 out of 16]: I should compute pixel rows 14 to 20, for a total of 7 rows
[Process 3 out of 16]: I should compute pixel rows 21 to 27, for a total of 7 rows
[Process 4 out of 16]: I should compute pixel rows 28 to 33, for a total of 6 rows
[Process 5 out of 16]: I should compute pixel rows 34 to 39, for a total of 6 rows
[Process 6 out of 16]: I should compute pixel rows 40 to 45, for a total of 6 rows
[Process 7 out of 16]: I should compute pixel rows 46 to 51, for a total of 6 rows
[Process 8 out of 16]: I should compute pixel rows 52 to 57, for a total of 6 rows
[Process 9 out of 16]: I should compute pixel rows 58 to 63, for a total of 6 rows
[Process 10 out of 16]: I should compute pixel rows 64 to 69, for a total of 6 rows
[Process 11 out of 16]: I should compute pixel rows 70 to 75, for a total of 6 rows
[Process 12 out of 16]: I should compute pixel rows 76 to 81, for a total of 6 rows
[Process 13 out of 16]: I should compute pixel rows 82 to 87, for a total of 6 rows
[Process 14 out of 16]: I should compute pixel rows 88 to 93, for a total of 6 rows
[Process 15 out of 16]: I should compute pixel rows 94 to 99, for a total of 6 rows</code></pre></figure>

    </div>
  </div>


  <div class=" title">
    <i class="dropdown icon"></i>
    See a sample execution with 16 processes for n=12 ...
  </div>

  <div class=" content">
    <div class="ui container segment raised">
      <h5 class="ui">Note that because n is small, some processes have nothing to do. (We don't care what
      these processes print as their range of rows).</h5>

<figure class="highlight"><pre><code class="language-text" data-lang="text">% smpicc -O3 1D_parallel_julia.c -o 1D_parallel_julia
% smpirun --cfg=smpi/running_power:1 -np 16 -hostfile ./simple_cluster_hostfile.txt -platform ./simple_cluster.xml ./1D_parallel_julia 100
[Process 1 out of 16]: I should compute pixel rows 1 to 1, for a total of 1 rows
[Process 2 out of 16]: I should compute pixel rows 2 to 2, for a total of 1 rows
[Process 3 out of 16]: I should compute pixel rows 3 to 3, for a total of 1 rows
[Process 4 out of 16]: I should compute pixel rows 4 to 4, for a total of 1 rows
[Process 5 out of 16]: I should compute pixel rows 5 to 5, for a total of 1 rows
[Process 6 out of 16]: I should compute pixel rows 6 to 6, for a total of 1 rows
[Process 7 out of 16]: I should compute pixel rows 7 to 7, for a total of 1 rows
[Process 8 out of 16]: I should compute pixel rows 8 to 8, for a total of 1 rows
[Process 9 out of 16]: I should compute pixel rows 9 to 9, for a total of 1 rows
[Process 10 out of 16]: I should compute pixel rows 10 to 10, for a total of 1 rows
[Process 11 out of 16]: I should compute pixel rows 11 to 11, for a total of 1 rows
[Process 12 out of 16]: I should compute pixel rows 12 to 11, for a total of 0 rows
[Process 13 out of 16]: I should compute pixel rows 12 to 11, for a total of 0 rows
[Process 14 out of 16]: I should compute pixel rows 12 to 11, for a total of 0 rows
[Process 15 out of 16]: I should compute pixel rows 12 to 11, for a total of 0 rows</code></pre></figure>

    </div>
  </div>


</div>



</div>



<div class="ui bottom attached tab segment" data-tab="1D_compute_julia">

  <p class="ui">
  Augment your program that that each process allocates space to store the pixels it needs to compute, and
  then computes them. <b>A process must only allocate space for the pixels it needs to compute</b>.  In practice,
  each process runs on a different hosts, and one wishes to compute a large image that does not fit in the
  memory of a single host (which is one of the main motivations for going the "distributed-memory computing" route).
</p>

<p class="ui">
  The main difficulty here is keeping local vs. global indexing straight. That is, although as a programmer
  with think of the image as an array of, say, N pixels, no N-pixel array is ever allocated in the program (only
  smaller arrays allocated on each process).
</p>

<div class="ui accordion fluid">

  <div class="title">
    <i class="dropdown icon"></i>
    See more details about this local/global indexing thing ...
  </div>

  <div class="content">

    <div class="ui container message ">

<p class="ui">One of the difficulties of distributed-memory computing is just that... well... memory is distributed.
      Say my sequential non-distributed-memory program processes 2000 items. I can simply store them
      in a 2000-item array.  Say now that I need to use distributed-memory computing (perhaps 2000 items don't
      fit in the memory of a single host, perhaps I just want to compute faster). I now use 20 hosts instead
      of 1, and on each host one process runs and allocates memory for 100 items.  So, at each process I allocate
      a 100-item array. So far, so good.</p>

      <p class="ui"> The problem is that when my sequential program says "process item #i", for some i between 0
        and 1999, I need to figure out two things:
      </p>

      <div class="ui list bulleted">
      <div class="ui item">Which process holds item #i?</div>
      <div class="ui item">In that process' item array, at which index is item #i stored?</div>
      </div>

      <p class="ui">
      The answer to the above depends on the data distribution!  Say that process 0 (i.e., process with
        rank 0) holds items 0 to 99 (global indices), process 1 holds items 100 to 199 (global indices), etc.
        So, for a given i between 0 and 1999, which this data distribution, I have:
      </p>
      <div class="ui list bulleted">
        <div class="ui item">Item #i is held by process with rank i/100</div>
        <div class="ui item">At that process, item #i is store at index i%100 of the item array</div>
      </div>

      <p class="ui">i%100 ("i modulo 100") above is called the <i>local index</i> (i.e., where the element is stored
      in the array declared locally in the process), as opposed to i which is the <i>global index</i>.</p>

      <p>The more complicated the distribution, the more intricate the global-to-local or local-to-global
      conversion. 1-D data distributions are the simplest. In an upcoming activity we'll deal with a 2-D
      data distribution.</p>

    </div>
  </div>
</div>



</div>



<div class="ui bottom attached tab segment" data-tab="1D_save_to_file">

  <p class="ui">
  Augment your program that that the Julia set is saved to a bmp file. This requires some coordination between the
  processes:
<div class="ui list bulleted">
  <div class="ui item">Only one process must create the file and write the header</div>
  <div class="ui item">Processes need to write pixel rows in sequence, one after the other</div>
  <div class="ui item">It's probably a good idea to have the file opened in only a single process at a time</div>
</div>
</p>

<p class="ui">
  First you must pick on process to create the file and write the header to it
  (it is typical to pick process of rank 0).  Second, each process, after its done computing
  its pixels, waits for a "go ahead!" message from its predecessor, and then sends a "go ahead!"
  message to its successor.  The exceptions are process of rank 0, which does not need to wait for
  a message, and the last process, which does not need to send a message. It doesn't really matter
  what these messages contain (e.g., they can be a single byte, or even zero-byte messages), as the whole purpose is to

</p>


<div class="ui accordion fluid">

  <div class="title">
    <i class="dropdown icon"></i>
    What are logical topologies???
  </div>

  <div class="content">
    <p class="ui message">
      Although the above scheme is pretty simple, what we are really doing is creating a <i>logical topology</i>. That is,
      based on ranks, we impose structure on our set of processes. In this case, a "linear chain" in which process #i communicates
      with process #i+1. Probably the simplest structure. We will see examples of more complex logical topologies.
      Different applications lend themselves naturally to different logical topologies (rings, grids, trees, etc.).
      One interesting question, which is outside
      the score of this topic, is how well the logical topology matches the physical topology of the actual
      parallel platform in use (a good match typically boosts performance).  Ideally, one can define a logical topology
      that makes writing the application intuitive, and that is also well-matched to the physical platform.
    </p>
  </div>
</div>




</div>
</div>

<div class="ui tab segment" data-tab="fourth">
  <div class="ui top attached tabular menu">
  <a class="item active" data-tab="second/a">2A</a>
  <a class="item" data-tab="second/b">2B</a>
  <a class="item" data-tab="second/c">2C</a>
</div>
<div class="ui bottom attached tab segment active" data-tab="second/a">2A</div>
<div class="ui bottom attached tab segment" data-tab="second/b">2B</div>
<div class="ui bottom attached tab segment" data-tab="second/c">2C</div>
</div>



  <br>

</div>
	</div>



</body>
</html>
